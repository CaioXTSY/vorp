<!DOCTYPE html>
<html lang="pt-br" x-data="{ mobileMenuOpen: false, isScrolled: false }" 
      :class="{ 'dark': darkMode }" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#6366f1">

  <!-- Tailwind CSS com plugins atualizados -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp,container-queries"></script>

  <!-- FontAwesome (ícones) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Fonte moderna (Inter) -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">

  <!-- Animações modernas -->
  <link rel="stylesheet" href="https://unpkg.com/@splidejs/splide@4.1.4/dist/css/splide.min.css">

  <style>
    :root {
      --color-primary: 99 102 241;
      --color-secondary: 139 92 246;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      @apply text-gray-800 bg-gradient-to-br from-gray-50 to-indigo-50/50 dark:bg-gray-900 dark:text-gray-100;
    }

    /* Navbar modernizada */
    .nav-header {
      @apply fixed w-full bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200/50 dark:border-gray-700 z-50;
      box-shadow: 0 1px 3px rgba(0,0,0,0.03), 0 2px 8px -2px rgba(0,0,0,0.04);
    }

    .nav-link {
      @apply relative px-3 py-2.5 text-sm font-medium text-gray-500 dark:text-gray-400 
             transition-all hover:text-indigo-600 dark:hover:text-indigo-400 
             after:absolute after:bottom-0 after:left-1/2 after:w-0 after:h-[2px] 
             after:bg-indigo-500 after:transition-all after:duration-300;
    }

    .nav-link:hover::after {
      @apply left-0 w-full;
    }

    /* Botões modernos */
    .btn-primary {
      @apply inline-flex items-center justify-center gap-2 px-5 py-2.5 rounded-lg 
             bg-gradient-to-br from-indigo-600 to-purple-600 text-white 
             hover:from-indigo-700 hover:to-purple-700 
             transition-all transform hover:-translate-y-0.5 
             shadow-sm hover:shadow-lg;
    }

    /* Cards */
    .card {
      @apply bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm 
             border border-gray-200/50 dark:border-gray-700 
             hover:shadow-md transition-shadow;
    }

    /* Alertas modernos */
    .alert {
      @apply p-4 rounded-xl border text-sm flex items-start gap-3;
    }
    .alert-success {
      @apply bg-emerald-50/50 border-emerald-200 text-emerald-700 dark:bg-emerald-900/20 dark:border-emerald-800 dark:text-emerald-300;
    }
    .alert-error {
      @apply bg-rose-50/50 border-rose-200 text-rose-700 dark:bg-rose-900/20 dark:border-rose-800 dark:text-rose-300;
    }

    /* Gradiente animado */
    .animated-gradient {
      background: linear-gradient(-45deg, #6366f1, #8b5cf6, #ec4899, #f59e0b);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
  </style>

  {% block head_extras %}{% endblock %}
</head>
<body class="min-h-screen flex flex-col">
  
  <!-- Cabeçalho Moderno -->
  <header class="nav-header" 
          x-data="{ isScrolled: window.pageYOffset > 10 }"
          @scroll.window="isScrolled = window.pageYOffset > 10">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="h-16 flex items-center justify-between">
        
        <!-- Logo com gradiente animado -->
        <a href="{{ url_for('index') }}" class="flex items-center space-x-2.5 group">
          <div class="w-9 h-9 rounded-lg bg-indigo-600 flex items-center justify-center 
                      group-hover:rotate-12 transition-transform">
            <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
            </svg>
          </div>
          <span class="text-xl font-semibold bg-clip-text 
                       bg-gradient-to-r from-indigo-600 to-purple-500 text-transparent">
            vorp
          </span>
        </a>

        <!-- Menu Desktop -->
        <div class="hidden md:flex items-center gap-6">
          <a href="{{ url_for('index') }}" class="nav-link">Home</a>
          {% if is_logged_in() %}
            <a href="{{ url_for('list_notes') }}" class="nav-link">Notas</a>
            <a href="{{ url_for('logout') }}" class="nav-link">Sair</a>
            {% if is_admin() %}
              <a href="{{ url_for('admin_page') }}" class="nav-link flex items-center gap-1.5">
                <span>Admin</span>
                <i class="fas fa-shield-alt text-sm text-emerald-500"></i>
              </a>
            {% endif %}
          {% else %}
            <a href="{{ url_for('login') }}" class="nav-link">Entrar</a>
            <a href="{{ url_for('register') }}" class="btn-primary">
              <i class="fas fa-rocket text-sm"></i>
              Começar Agora
            </a>
          {% endif %}
        </div>

        <!-- Botão Mobile -->
        <button @click="mobileMenuOpen = !mobileMenuOpen" 
                class="md:hidden p-2 -mr-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition">
          <i class="fas fa-bars text-gray-600 dark:text-gray-400 text-xl"></i>
        </button>
      </div>
    </nav>
  </header>

  <!-- Menu Mobile Moderno -->
  <div class="md:hidden fixed inset-0 bg-black/30 z-50 backdrop-blur-sm"
       x-show="mobileMenuOpen"
       x-transition:enter="transition ease-out duration-200"
       x-transition:leave="transition ease-in duration-150"
       x-cloak
       style="display: none;">
    <div class="absolute top-4 right-4 w-[calc(100%-2rem)] max-w-xs bg-white dark:bg-gray-800 
                rounded-xl shadow-2xl p-4" @click.outside="mobileMenuOpen = false">
      <div class="flex flex-col gap-2">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-semibold text-gray-900 dark:text-white">Menu</h3>
          <button @click="mobileMenuOpen = false" class="p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
            <i class="fas fa-times text-lg"></i>
          </button>
        </div>
        
        {% if is_logged_in() %}
          <a href="{{ url_for('list_notes') }}" class="flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg">
            <i class="fas fa-file-alt w-5 text-gray-400"></i>
            <span>Minhas Notas</span>
          </a>
          <a href="{{ url_for('logout') }}" class="flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg">
            <i class="fas fa-sign-out-alt w-5 text-gray-400"></i>
            <span>Sair</span>
          </a>
        {% else %}
          <a href="{{ url_for('login') }}" class="flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg">
            <i class="fas fa-sign-in-alt w-5 text-gray-400"></i>
            <span>Entrar</span>
          </a>
          <a href="{{ url_for('register') }}" class="btn-primary w-full justify-center mt-2">
            Criar Conta
          </a>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Conteúdo Principal -->
  <main class="flex-grow pt-2">
    <div class=" sm:px-1200 ">
      <!-- Mensagens Flash Modernas -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="space-y-3 mb-8">
            {% for category, msg in messages %}
              <div class="alert alert-{{ 'success' if category == 'success' else 'error' }}">
                <i class="fas {{ 'fa-check-circle' if category == 'success' else 'fa-exclamation-triangle' }} 
                   text-[0.9em] mt-0.5"></i>
                <div>{{ msg }}</div>
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </div>
  </main>

  <!-- Rodapé Moderno -->
  <footer class="bg-gray-950 text-gray-300 ">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8 border-b border-gray-800 pb-12">
        <!-- Branding -->
        <div class="space-y-5">
          <div class="flex items-center gap-3">
            <div class="p-2 bg-indigo-600 rounded-lg">
              <i class="fas fa-graduation-cap text-white text-xl"></i>
            </div>
            <span class="text-xl font-bold text-white">CAIOBOOK</span>
          </div>
          <p class="text-sm leading-relaxed text-gray-400">
            Aprendizado inteligente para mentes curiosas.
          </p>
        </div>

        <!-- Links -->
        <div class="space-y-4">
          <h4 class="text-sm font-semibold text-gray-200 uppercase">Produto</h4>
          <ul class="space-y-3">
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Recursos</a></li>
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Planos</a></li>
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Documentação</a></li>
          </ul>
        </div>

        <!-- Suporte -->
        <div class="space-y-4">
          <h4 class="text-sm font-semibold text-gray-200 uppercase">Suporte</h4>
          <ul class="space-y-3">
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Central de Ajuda</a></li>
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Contato</a></li>
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Status</a></li>
          </ul>
        </div>

        <!-- Legal -->
        <div class="space-y-4">
          <h4 class="text-sm font-semibold text-gray-200 uppercase">Legal</h4>
          <ul class="space-y-3">
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Privacidade</a></li>
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Termos</a></li>
            <li><a href="#" class="text-sm hover:text-indigo-400 transition">Segurança</a></li>
          </ul>
        </div>
      </div>

      <!-- Copyright -->
      <div class="pt-8 text-center">
        <p class="text-sm text-gray-500">
          © {{ current_year }} CAIOBOOK. Todos os direitos reservados.
        </p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/alpinejs" defer></script>
  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.store('darkMode', {
        on: window.matchMedia('(prefers-color-scheme: dark)').matches,

        toggle() {
          this.on = !this.on
          document.documentElement.classList.toggle('dark', this.on)
        }
      })
    })
  </script>

  {% block socket_config %}{% endblock %}
</body>
</html>