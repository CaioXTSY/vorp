{% extends "base.html" %}
{% block title %}Perfil de {{ user.username }}{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto py-10 px-4">
  <!-- Card de Perfil -->
  <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200/50 dark:border-gray-700 flex flex-col md:flex-row items-center gap-6">
    <!-- Foto de Perfil -->
    <div class="shrink-0">
      {% if user.profile_photo %}
        <img src="{{ user.profile_photo }}" alt="Foto de Perfil" class="w-32 h-32 rounded-full object-cover border-4 border-indigo-100 dark:border-gray-700" />
      {% else %}
        <div class="w-32 h-32 flex items-center justify-center bg-gradient-to-br from-indigo-500 to-blue-600 text-white text-4xl font-semibold rounded-full">
          <i class="fas fa-user"></i>
        </div>
      {% endif %}
    </div>
    <!-- Infos -->
    <div class="flex-1">
      <h1 class="text-2xl font-bold text-gray-800 dark:text-white">
        {% if user.full_name %} 
          {{ user.full_name }}
        {% else %}
          {{ user.username }}
        {% endif %}
      </h1>
      <p class="text-sm text-gray-500">@{{ user.username }}</p>
      <p class="mt-3 text-gray-700 dark:text-gray-200">
        {% if user.bio %}
          {{ user.bio }}
        {% else %}
          <span class="italic text-gray-400">Nenhuma biografia informada.</span>
        {% endif %}
      </p>
      <!-- Gênero, se existir -->
      {% if user.gender %}
        <div class="mt-3 text-sm bg-gray-100 dark:bg-gray-700 px-3 py-1.5 rounded-lg inline-block">
          <i class="fas fa-venus-mars mr-2"></i> {{ user.gender }}
        </div>
      {% endif %}
      
      <!-- Botão de Editar se for o próprio usuário -->
      {% if is_logged_in() and session['user_id'] == user.id %}
        <div class="mt-4">
          <a href="{{ url_for('edit_profile') }}" class="inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg shadow hover:bg-indigo-700">
            <i class="fas fa-user-edit mr-2"></i>
            Editar Perfil
          </a>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Notas do usuário -->
  <div class="mt-10">
    <h2 class="text-xl font-semibold mb-4 text-gray-800 dark:text-white">Notas de {{ user.username }}</h2>
    {% if notes %}
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for note in notes %}
          <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md border border-gray-200/60 dark:border-gray-700 transition hover:shadow-lg">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-2">
              {{ note.title }}
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
              Atualizado em: {{ note.updated_at|datetime_format }}
            </p>
            <a href="{{ url_for('view_note', note_id=note.id) }}" class="text-indigo-600 dark:text-indigo-400 font-medium hover:underline inline-flex items-center gap-2">
              <i class="fas fa-external-link-alt"></i>
              Acessar Nota
            </a>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-gray-500 dark:text-gray-400">Este usuário não possui notas visíveis.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
